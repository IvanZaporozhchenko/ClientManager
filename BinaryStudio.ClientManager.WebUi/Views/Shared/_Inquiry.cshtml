@using BinaryStudio.ClientManager.DomainModel.Infrastructure
@using Microsoft.Web.Mvc
@model WeekViewModel

@helper MoveForward(string text, DateTime date)
{
    <li><a href="#" data-bind="click: $root.ClickMoveTo.bind($data,'@date.ToString("yyyy-MM-dd")')"><span class="icon-arrow-right"></span> <span> @text (@date.ToString("dd.MM")) </span></a></li>
}

<li class="inquiry" data-bind="visible: Visible">
    <a data-bind="attr: { href: DetailsUri}">
        <div class="row-fluid">
            <div class="span4">
                @*Add Or extension*@
                <img class="pull-left" data-bind="attr: {src: PhotoUri}" alt="Photo" width="48" height="48"/>
            </div>
            <div class="span8 primary-info">
                <span class="name" data-bind="text: Name"></span>
                <span class="subject" data-bind="text: Subject"></span>
            </div>
        </div>
    </a>
    <div class="secondary-info">
        <div class="phone"><span class="icon-headphones"></span> <span data-bind="text: Phone"></span></div>    @*@Html.SkypeLink(inquiry.Phone)*@
        <div class="email"><span class="icon-envelope"></span> <span data-bind="text: Email"></span></div>   @* @Html.Email(inquiry.Email, inquiry.Email.Cut(20))*@
        <div>
            <span class="icon-user"></span> <span data-bind="text: Assignee"></span> @*@inquiry.Assignee.Cut(20).Or("N/A")*@
            <div class="pull-right dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                    Menu<span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                    <li>
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <span class="icon-user"></span> Assign to
                        </a>
                        <ul class="dropdown-menu sub-menu" data-bind="foreach: $root.Employees">
                            <li><a href="#" data-bind="text: FullName, click: $root.ClickAssign.bind($data,$parent)"></a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <span class="icon-tag"></span> Add tag
                        </a>
                        <ul class="dropdown-menu sub-menu" data-bind="foreach: $root.Tags">                          
                            <li><a href="#" data-bind="text: Name, click: $root.ClickAddTag.bind($data,$parent)"></a></li>                            
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <span class="icon-calendar"></span> Move to
                        </a>
                        <ul class="dropdown-menu sub-menu">
                             @{
                                var day = Clock.Now.Date;    
                                @MoveForward("1 day", day.AddDays(1))
                                @MoveForward("2 days", day.AddDays(2))
                                @MoveForward("3 days", day.AddDays(3))
                                @MoveForward("1 week", day.AddDays(7))
                             }
                        </ul>
                    </li>
                    <li>
                        <a href="#comment-editor" data-toggle="modal" data-bind="click: $root.ClickAddComment.bind($parent)"><span class="icon-pencil"></span> Add comment</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</li>

@Html.Script("CommonViewsScript.js")